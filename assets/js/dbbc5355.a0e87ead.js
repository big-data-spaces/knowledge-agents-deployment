"use strict";(self.webpackChunkcatenax_ng=self.webpackChunkcatenax_ng||[]).push([[66],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return h}});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=a.createContext({}),u=function(e){var n=a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},s=function(e){var n=u(e.components);return a.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,c=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),d=u(t),h=o,g=d["".concat(c,".").concat(h)]||d[h]||p[h]||r;return t?a.createElement(g,l(l({ref:n},s),{},{components:t})):a.createElement(g,l({ref:n},s))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=d;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var u=2;u<r;u++)l[u]=t[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},4238:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return c},default:function(){return h},frontMatter:function(){return i},metadata:function(){return u},toc:function(){return p}});var a=t(7462),o=t(3366),r=(t(7294),t(3905)),l=["components"],i={sidebar_position:3,title:"How To (Spike)"},c="Source Repository",u={unversionedId:"howto",id:"howto",title:"How To (Spike)",description:"You will find the source code of the Spike  under https://github.com/catenax-ng/product-knowledge",source:"@site/docs/howto.md",sourceDirName:".",slug:"/howto",permalink:"/product-knowledge/docs/howto",editUrl:"https://github.com/catenax-ng/product-knowledge/edit/main/docs/howto.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"How To (Spike)"},sidebar:"tutorialSidebar",previous:{title:"Architecture",permalink:"/product-knowledge/docs/architecture"}},s={},p=[{value:"Building under MacOS/M=&gt;1",id:"building-under-macosm1",level:2},{value:"Building/Patching Jena",id:"buildingpatching-jena",level:2},{value:"Building/Patching Eclipse Dataspace Connector",id:"buildingpatching-eclipse-dataspace-connector",level:2},{value:"Building Knowledge Agents",id:"building-knowledge-agents",level:2},{value:"Running the Spike components",id:"running-the-spike-components",level:2}],d={toc:p};function h(e){var n=e.components,t=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"source-repository"},"Source Repository"),(0,r.kt)("p",null,"You will find the source code of the Spike  under ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/catenax-ng/product-knowledge/tree/feature/ART3-375-spike"},"https://github.com/catenax-ng/product-knowledge")," "),(0,r.kt)("p",null,"Be sure to initialise the git submodules after cloning the repo"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"git submodule update --init --recursive\n")),(0,r.kt)("h1",{id:"building-packages-and-running-locally"},"Building Packages and Running Locally"),(0,r.kt)("p",null,"You will need a JDK>=11 installed in the JAVA_HOME environment variable.\nYou will need Apache Maven installed in the PATH environment variable.\nYou will need internet access and (optionally) a proxy installed in the HTTP_PROXY_HOST and HTTP_PROXY_PORT environment variables.\nYou will need node.js/npm installed.\nThe build process will install a (local) gradle build tool during the run."),(0,r.kt)("h2",{id:"building-under-macosm1"},"Building under MacOS/M=>1"),(0,r.kt)("p",null,"There is currently ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/square/okhttp/issues/6943"},"no auto-configurable Java 11 toolchain for gradle"),"."),(0,r.kt)("p",null,"We recommend to download/install the ",(0,r.kt)("a",{parentName:"p",href:"https://www.azul.com/downloads/?os=macos&architecture=arm-64-bit&package=jdk"},"Azul JDK 11")," and execute the\nfollowing commands"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# Adapt to the path of your Azul JDK11\nexport JDK11=~/Projects/jdk/zulu11.54.25-ca-jdk11.0.14.1-macosx_aarch64\nexport GRADLE_PROPS=(--no-parallel -Porg.gradle.java.installations.fromEnv=JDK11 -Pversion=0.0.3-CATENAX)\n")),(0,r.kt)("p",null,"If you want to run the resulting docker images locally without emulation (and do not plan to publish them to non-Apple registries),\nyou may also"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# Use the right docker platform for running\nexport DOCKER_PLATFORM=linux/arm64\n")),(0,r.kt)("h2",{id:"buildingpatching-jena"},"Building/Patching Jena"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"cd jena\ngit apply ../src/patch/jena.patch\ncd jena-fuseki2\nmvn install -DskipTests -Denforcer.skip=true -Dmaven.javadoc.skip=true\ncd ..\ngit restore .\ncd ..\n")),(0,r.kt)("h2",{id:"buildingpatching-eclipse-dataspace-connector"},"Building/Patching Eclipse Dataspace Connector"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"cd DataSpaceConnector\n./gradlew $GRADLE_PROPS -Dhttps.proxyHost=${HTTP_PROXY_HOST} -Dhttps.proxyPort=${HTTP_PROXY_PORT} publishToMavenLocal -x test\ncd ..\n")),(0,r.kt)("h2",{id:"building-knowledge-agents"},"Building Knowledge Agents"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"./gradlew $GRADLE_PROPS -Dhttps.proxyHost=${HTTP_PROXY_HOST} -Dhttps.proxyPort=${HTTP_PROXY_PORT} build\n")),(0,r.kt)("h2",{id:"running-the-spike-components"},"Running the Spike components"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"# Run a single backend data plane\n./run_local.sh -complete -internal &\n# Run three agents\n./run_local.sh -tenant1 -external &\n./run_local.sh -tenant2 -external &\n./run_local.sh -central -external &\n# Run the portal\ncd tractusx/portal/code/tractus-x-portal\nnpm install npm@latest --force\nnpm start\n")),(0,r.kt)("p",null,"You should now be able to access the APIs via this Postman Workspace ",(0,r.kt)("a",{parentName:"p",href:"https://www.postman.com/catena-x/workspace/catena-x-knowledge-agents"},"https://www.postman.com/catena-x/workspace/catena-x-knowledge-agents"),' (choose the "Localhost" environment).'),(0,r.kt)("p",null,"You may need to execute the first two upload commands in the Data Plane (internal) folder to populate the backend."),(0,r.kt)("p",null,"You should then be able to access the portal via http://localhost:3000 for which you need an account in the Catena-X Speedboat directory.\nAnd you should use Google Chrome (because of the pre-installed HTML5-speechkit voices)."),(0,r.kt)("h1",{id:"building-docker-images-and-running-locally"},"Building Docker Images and Running Locally"),(0,r.kt)("p",null,"Once the packages are compiled, the following command will build all docker images"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"docker compose build\n")),(0,r.kt)("p",null,"There is a ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/catenax-ng/product-knowledge/blob/feature/ART3-375-spike/README.md"},"script")," which does that and\nalso publishes the resulting images (only linux/amd64) directly to the Catena-X registry (for which you need a valid github account)."),(0,r.kt)("p",null,"The following images are built (and are also available for direct pull under linux/amd64):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"docker pull ghcr.io/catenax-ng/product-knowledge/data-plane-agent:0.0.1\ndocker pull ghcr.io/catenax-ng/product-knowledge/control-plane:0.0.1\ndocker pull ghcr.io/catenax-ng/product-knowledge/portal:0.0.1\n")),(0,r.kt)("p",null,"Running the spike via docker is then done via"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"docker compose up\n")),(0,r.kt)("p",null,"You should now be able to access the APIs via this Postman Workspace ",(0,r.kt)("a",{parentName:"p",href:"https://www.postman.com/catena-x/workspace/catena-x-knowledge-agents"},"https://www.postman.com/catena-x/workspace/catena-x-knowledge-agents"),' (choose the "Localhost" environment).'),(0,r.kt)("p",null,"You may need to execute the first two upload commands in the Data Plane (internal) folder to populate the backend."),(0,r.kt)("p",null,"You should then be able to access the portal via http://localhost:3000 for which you need an account in the Catena-X Speedboat directory.\nAnd you should use Google Chrome (because of the pre-installed HTML5-speechkit voices)."),(0,r.kt)("h1",{id:"using-a-helm-chartkubernetes-deployment"},"Using a Helm Chart/Kubernetes Deployment"),(0,r.kt)("p",null,"You could mount the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/catenax-ng/product-knowledge/tree/feature/ART3-375-spike/helm"},"helm folder of the repository"),"  also in Argo CD or\nan equivalent mechanism. "),(0,r.kt)("p",null,"Please be aware that this is currently not configurable, e.g. to non-Catena-X environments."))}h.isMDXComponent=!0}}]);